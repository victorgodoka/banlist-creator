  <!DOCTYPE html>
  <html>

  <head>
    <!--Import Google Icon Font-->
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <!--Import materialize.css-->
    <link type="text/css" rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/css/materialize.min.css"
      media="screen,projection" />
    <title>Banlist Creator</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="shortcut icon" href="yugioh.ico" type="image/x-icon" />
    <style>
      body {
        display: flex;
        min-height: 100vh;
        flex-direction: column;
        font-size: 16px;
      }

      main {
        flex: 1 0 auto;
      }

      .align-right {
        width: 100%;
        text-align: right;
      }

      .loading__wrapper {
        position: absolute;
        z-index: 2;
        background-color: rgba(0, 0, 0, .65);
        top: 0;
        left: 0;
        display: flex;
        align-items: center;
        justify-content: center;
        width: 100vw;
        height: 100vh;
      }

      .hide {
        display: none !important;
      }

      .form {
        margin: 20px 0;
      }

      .warning {
        padding: 20px;
        margin: 0;
      }

      .warning__text {
        padding: 0;
        margin: 0;
        display: inline-block;
        color: #fafafa;
      }

      .warning pre {
        font-family: monospace;
        display: inline;
        padding: 3px 4px;
      }

      .bold {
        font-weight: bold;
      }

      .banlist {
        font-family: monospace;
        line-height: 2;
        background-color: rgba(0, 0, 0, .1);
        padding: 20px;
        width: 100%;
        list-style: none;
        border: 1px dashed rgba(0, 0, 0, .65);
      }

      .disclaimer {
        margin-bottom: 20px;
      }

      .disclaimer__text {
        font-family: monospace;
        line-height: 2;
        font-size: .65rem;
      }
    </style>
  </head>

  <body>

    <header class="warning pink darken-3 z-depth-2">
      <div class="warning__text">Create a file with extension
        <pre class="grey">.lflist.conf</pre> in your
        <pre class="grey">lflists</pre> in your EdoPro folder. Copy the list below into this file.</div>
      </div>
    </header>

    <main class="container">
      <div class="loading__wrapper">
        <div class="preloader-wrapper active">
          <div class="spinner-layer spinner-red-only">
            <div class="circle-clipper left">
              <div class="circle"></div>
            </div>
            <div class="gap-patch">
              <div class="circle"></div>
            </div>
            <div class="circle-clipper right">
              <div class="circle"></div>
            </div>
          </div>
        </div>
      </div>

      <form id="form" class="form">
        <div class="row">
          <div class="col s12">
            <div class="row">
              <div class="input-field col s8">
                <i class="material-icons prefix">collections</i>
                <input type="text" id="cardname" class="autocomplete">
                <label for="cardname">Cardname</label>
              </div>
              <div class="input-field col s2">
                <input type="number" min="0" max="2" id="limit" value="0">
                <label for="limit">Limit (0, 1, 2)</label>
              </div>
              <button class="waves-effect waves-light btn" type="submit">Add</button>
            </div>
          </div>
        </div>
      </form>
      <ul class="browser-default banlist" id="list">

      </ul>
    </main>

    <footer class="page-footer pink darken-3 z-depth-2">
      <div class="container disclaimer">
        <div class="disclaimer__text pink-text text-lighten-3 flow-text">Made using <a class="pink-text text-lighten-5" href="https://ygoprodeck.com" target="_blank">YGOPRODeck.com API</a>.</div>
        <div class="disclaimer__text pink-text text-lighten-3 flow-text">The literal and graphical information presented on this site about
          Yu-Gi-Oh!, including
          card images, the
          attribute, level/rank and type symbols, and card text, is copyright 4K Media Inc, a subsidiary of Konami
          Digital
          Entertainment, Inc. This website is not produced by, endorsed by, supported by, or affiliated with 4k Media or
          Konami Digital Entertainment.</div>
      </div>
      <div class="footer-copyright">
        <div class="container align-right">
          Â© <span id="current-year"></span>
          <a class="grey-text text-lighten-4" href="https://twitter.com/victorgodoka" target="_blank">@victorgodoka</a>
        </div>
      </div>
    </footer>
    <!--JavaScript at end of body for optimized loading-->
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/js/materialize.min.js">
    </script>

    <script>
      const DICT = {
        0: 'Forbidden',
        1: 'Limited',
        2: 'Semi-Limited',
      }

      function toggleLoading() {
        document.querySelector('.loading__wrapper').classList.toggle('hide');
      }

      function loadAllCards(set, cb) {
        return fetch('https://db.ygoprodeck.com/api/v7/cardinfo.php')
          .then(res => res.json())
          .then(({
            data
          }) => set(data))
          .finally(() => cb())
      }

      function convertCardsIntoObject(cards) {
        let obj = {}
        cards.forEach(card => {
          obj[card.name] = `https://storage.googleapis.com/ygoprodeck.com/pics/${card.id}.jpg`
        });

        return obj;
      }

      function addCard(selected, cardLimit, cards) {
        window.selectedCards = window.selectedCards || []
        window.selectedCardsByLimitation = window.selectedCardsByLimitation || [
          [],
          [],
          []
        ]
        let selectedCardData = cards.find(card => card.name === selected)
        let findDuplicate = window.selectedCards.find(card => card.name === selected)
        if (!findDuplicate) {
          window.selectedCards.push(selectedCardData)
          window.selectedCardsByLimitation[cardLimit].push(selectedCardData)
        }
        updateSelected()
      }

      function updateSelected() {
        document.querySelector('#list').innerHTML =
          window.selectedCardsByLimitation.map(function (cards, i) {
            return `<li class="bold">#${DICT[i]}</li>` + cards.map(card => `<li>${card.id} ${i} --${card.name}</li>`)
              .join("")
          }).join("")
      }

      function setAutocomplete(cards) {
        window.fullCards = cards;
        var elems = document.querySelectorAll('.autocomplete');
        var instances = M.Autocomplete.init(elems, {
          data: convertCardsIntoObject(cards),
          limit: 10,
          minLength: 3
        });
      }

      function getValue(id) {
        return document.querySelector("#" + id).value
      }

      document.addEventListener("DOMContentLoaded", async function (event) {
        loadAllCards(setAutocomplete, toggleLoading)
        document.querySelector("#current-year").innerHTML = new Date().getFullYear()
        document.querySelector("#form").addEventListener("submit", function (e) {
          e.preventDefault();
          addCard(getValue('cardname'), getValue('limit'), window.fullCards)
        })
      });
    </script>
  </body>

  </html>